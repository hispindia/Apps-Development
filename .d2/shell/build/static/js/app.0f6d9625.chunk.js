"use strict";(self.webpackChunk_dhis2_app_shell=self.webpackChunk_dhis2_app_shell||[]).push([[2143],{8593:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var n=a(969),l=a(1949),r=(a(4144),"App_desgin__1c78E"),i="App_zebraStriping__zBtUM",o="App_darkTable__ohDSI",u="App_lightTable__6Pf8+",s="App_light-mode__AE4fG",d="App_dark-mode__fIzxz",c=(a(4551),a(6309)),m=a(8382),v=a(964),p=a(3582),E=a(4359),g=a(7212),f="Model_modal__wrap__x3xy-",y="Model_visible__sINfZ",k="Model_modal__sifuU";var b=e=>{let{modalStyle:t,children:a,show:l,onClose:r,backdropStyle:i}=e;const o=(0,n.useRef)(null);return(0,n.useEffect)((()=>{l?o.current.classList.add(y):o.current.classList.remove(y)}),[l]),n.createElement(n.Fragment,null,n.createElement("div",{ref:o,className:`${f}`,onClick:r},n.createElement("div",{style:t,className:`${k} flex flex-col`},n.createElement("button",{onClick:r,className:"ml-auto py-0 px-2",style:{border:"none",background:"#e5e5e5"}},n.createElement("i",{class:"fa-solid fa-xmark bold",style:{color:"#444",fontSize:"14px"}})),a)))};function h(e,t,a){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class S{}h(S,"EventAPi",(async(e,t)=>(await fetch(`https://links.hispindia.org/timor/api/events.json?skipPaging=true&program=${e}&trackedEntityInstance=${t.id}&fields=dataValues[dataElement,value],eventDate,programStage,status`,{method:"GET"})).json())),h(S,"ProgramStages",(async()=>(await fetch("https://links.hispindia.org/timor/api/programStages.json?paging=false&fields=id,name",{method:"GET"})).json())),h(S,"AllDataelement",(async()=>(await fetch("https://links.hispindia.org/timor/api/dataElements.json?paging=false&domainType=TRACKER&fields=id,name",{method:"GET"})).json())),h(S,"Programoptions",(async()=>(await fetch("https://links.hispindia.org/timor/api/29/sqlViews/oZAXWFlZgI7/data?paging=false",{method:"GET"})).json())),h(S,"tableDataplot",(async e=>(await fetch(`https://links.hispindia.org/timor/api/trackedEntityInstances.json?ou=Fn51zf6ifbm&program=${encodeURIComponent(e)}&ouMode=DESCENDANTS`,{method:"GET"})).json())),h(S,"tableHeaderData",(async e=>(await fetch(`https://links.hispindia.org/timor/api/programs/${e}.json?fields=programTrackedEntityAttributes%5BtrackedEntityAttribute%5Bid,name,formName,attributeValues%5Battribute%5Bid,name,code%5D,value%5D%5D%5D`,{method:"GET"})).json()));var A=()=>{var e,t,a;const[l,f]=(0,n.useState)([]),[y,k]=(0,n.useState)(""),[h,A]=(0,n.useState)([]),[_,w]=(0,n.useState)(""),[T,D]=(0,n.useState)(!1),[C,N]=(0,n.useState)([]),[P,j]=(0,n.useState)([]),[I,R]=(0,n.useState)({}),[x,M]=(0,n.useState)({value:!1,id:""}),[V,G]=(0,n.useState)([]),[F,$]=(0,n.useState)([]),[z,B]=(0,n.useState)([]),[Z,O]=(0,n.useState)(""),[U,L]=(0,n.useState)("true"===localStorage.getItem("darkMode"));(0,n.useEffect)((()=>{localStorage.setItem("darkMode",U)}),[U]);(0,n.useRef)(null);console.log("programStages>>>>>>>",F),console.log("eventData>>>>>",V),console.log("dataElements>>>>>>",z),(0,n.useEffect)((()=>{1==x.value&&async function(){const e=await S.EventAPi(y,x);G(e)}()}),[x]),(0,n.useEffect)((()=>{!async function(){var e;const t=await S.Programoptions();f(null===t||void 0===t||null===(e=t.listGrid)||void 0===e?void 0:e.rows)}(),async function(){const e=await S.ProgramStages(),t=await S.AllDataelement();$(e),B(t)}()}),[]),(0,n.useEffect)((()=>{!async function(){var e;const t=await S.tableDataplot(y);A(null===t||void 0===t?void 0:t.trackedEntityInstances),w(null===t||void 0===t||null===(e=t.trackedEntityInstances)||void 0===e?void 0:e.length)}(),async function(){const e=await S.tableHeaderData(y);N(e)}()}),[y]),(0,n.useEffect)((()=>{!function(e){const t=[];if(void 0!==(null===e||void 0===e?void 0:e.programTrackedEntityAttributes))for(var a=0;a<e.programTrackedEntityAttributes.length;a++){var n,l;if(void 0!==(null===(n=e.programTrackedEntityAttributes[a])||void 0===n||null===(l=n.trackedEntityAttribute)||void 0===l?void 0:l.attributeValues))for(var r=0;r<e.programTrackedEntityAttributes[a].trackedEntityAttribute.attributeValues.length;r++){var i,o,u;if("showInConsent"===(null===(i=e.programTrackedEntityAttributes[a].trackedEntityAttribute.attributeValues[r])||void 0===i||null===(o=i.attribute)||void 0===o?void 0:o.code)&&"true"===(null===(u=e.programTrackedEntityAttributes[a].trackedEntityAttribute.attributeValues[r])||void 0===u?void 0:u.value)){const n={attribute:e.programTrackedEntityAttributes[a].trackedEntityAttribute.id,displayName:e.programTrackedEntityAttributes[a].trackedEntityAttribute.name,value:""};t.push(n),j(t),console.log("getting the Blank array data",t)}}}}(C)}),[C]);const[q,H]=(0,n.useState)(1);return n.createElement(n.Fragment,null,n.createElement("div",{className:U?d:s,style:{overflow:"auto"}},n.createElement("div",{style:{padding:"5px"}},n.createElement("div",null,l.length>0&&n.createElement("select",{onChange:e=>{const t=JSON.parse(e.target.value);k(t.id),O(t.name)}},n.createElement("option",{value:""},"Select Program for Event List"),l.map((e=>n.createElement("option",{key:e[0],value:JSON.stringify({id:e[0],name:e[1]})},e[1])))),n.createElement("button",{onClick:()=>{L(!U)}},U?"Light Mode":"Dark Mode")),n.createElement(b,{show:x.value,onClose:()=>M({value:!1})},n.createElement(v.i,{className:U?o:u},n.createElement(c.S,null,n.createElement(m.p,null,"Selected Program:"),n.createElement(m.p,null,Z||"")),null===V||void 0===V||null===(e=V.events)||void 0===e?void 0:e.map(((e,t)=>{var a,l;return n.createElement("div",null,n.createElement(c.S,null,n.createElement(m.p,null,"Program Stage:"),n.createElement(m.p,null,(e=>{var t;const a=null===F||void 0===F||null===(t=F.programStages)||void 0===t?void 0:t.find((t=>t.id===e));return a?a.name:"Unknown"})(null===e||void 0===e?void 0:e.programStage))),n.createElement(c.S,{className:i},n.createElement(m.p,null,"Event Date:"),n.createElement(m.p,null,e.eventDate?e.eventDate.split("T")[0]:"")),n.createElement(c.S,null,n.createElement(m.p,null,"Status:"),n.createElement(m.p,null,e.status)),(null===e||void 0===e||null===(a=e.dataValues)||void 0===a?void 0:a.length)>0&&n.createElement(n.Fragment,null,n.createElement("span",null,"DataElements"),n.createElement(c.S,{className:i},null===e||void 0===e||null===(l=e.dataValues)||void 0===l?void 0:l.map(((e,t)=>n.createElement(c.S,{key:t,className:i},n.createElement(m.p,null,(e=>{var t;const a=null===z||void 0===z||null===(t=z.dataElements)||void 0===t?void 0:t.find((t=>t.id===e));return a?a.name:"Unknown"})(null===e||void 0===e?void 0:e.dataElement),":"),n.createElement(m.p,null," ",e.value)))))))})))),n.createElement("div",{className:r},n.createElement("a",{id:"dlink"}),n.createElement("div",{id:"report-table"},n.createElement(v.i,{className:U?o:u},n.createElement(c.S,null,null===C||void 0===C||null===(t=C.programTrackedEntityAttributes)||void 0===t?void 0:t.map((e=>{var t,a;return n.createElement(m.p,{key:null===e||void 0===e||null===(t=e.trackedEntityAttribute)||void 0===t?void 0:t.id,style:{whiteSpace:"nowrap"}},n.createElement("b",null,null===e||void 0===e||null===(a=e.trackedEntityAttribute)||void 0===a?void 0:a.name))}))),n.createElement(c.S,null,null===C||void 0===C||null===(a=C.programTrackedEntityAttributes)||void 0===a?void 0:a.map((e=>{var t,a,l;return n.createElement(n.Fragment,{key:null===e||void 0===e||null===(t=e.trackedEntityAttribute)||void 0===t?void 0:t.id},n.createElement(m.p,{key:null===e||void 0===e||null===(a=e.trackedEntityAttribute)||void 0===a?void 0:a.id,style:{whiteSpace:"nowrap"}},n.createElement("input",{type:"text",placeholder:`Search ${null===e||void 0===e||null===(l=e.trackedEntityAttribute)||void 0===l?void 0:l.name}`,onChange:t=>{var a,n,l;return n=null===e||void 0===e||null===(a=e.trackedEntityAttribute)||void 0===a?void 0:a.id,l=t.target.value,void R((e=>({...e,[n]:l})))}})))}))),T?n.createElement("div",null,n.createElement(g.Z,null)):n.createElement(p.R,null,(()=>{const e=10*q,t=e-10;if(void 0!==h){return h.filter((e=>Object.keys(I).every((t=>{const a=I[t],n=e.attributes.find((e=>e.attribute===t));return!a||n&&n.value.includes(a)})))).slice(t,e).map(((e,t)=>{var a;return n.createElement(c.S,{key:t,className:i},null===C||void 0===C||null===(a=C.programTrackedEntityAttributes)||void 0===a?void 0:a.map((t=>{var a;const l=e.attributes.find((e=>{var a;return e.attribute===(null===t||void 0===t||null===(a=t.trackedEntityAttribute)||void 0===a?void 0:a.id)})),r=e.trackedEntityInstance;return n.createElement(m.p,{key:null===t||void 0===t||null===(a=t.trackedEntityAttribute)||void 0===a?void 0:a.id},n.createElement("div",{onClick:()=>M({value:!0,id:r})},l?l.value:""))})))}))}return null})()))),n.createElement(E.Z,{activePage:q,itemsCountPerPage:10,totalItemsCount:_,pageRangeDisplayed:5,onChange:e=>{H(e)},itemClass:"page-item",linkClass:"page-link"})))))};const _={me:{resource:"me"}};var w=()=>n.createElement("div",null,n.createElement(l.ZR,{query:_},(e=>{let{error:t,loading:a,data:l}=e;return t?n.createElement("span",null,"ERROR"):a?n.createElement("span",null,"..."):n.createElement(n.Fragment,null,n.createElement(A,null))})))}}]);
//# sourceMappingURL=app.0f6d9625.chunk.js.map