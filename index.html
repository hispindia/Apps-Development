<!doctype html>
<html class="no-js" lang="">

<head>
    <meta charset="utf-8">
    <title></title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"
        integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">


    <style>
        table {
            border-collapse: collapse;
        }

        thead>tr>td {
            font-weight: bold;
        }

        tbody>tr>td {
            font-weight: bold;
        }

        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            opacity: 1;
        }

        /* Center the loader  */
        #loader {
            position: absolute;
            left: 50%;
            top: 50%;
            z-index: 1;
            width: 150px;
            height: 150px;
            margin: -75px 0 0 -75px;
            border: 16px solid #f3f3f3;
            border-radius: 50%;
            border-top: 16px solid #34B4DB;
            width: 120px;
            height: 120px;
            -webkit-animation: spin 2s linear infinite;
            animation: spin 2s linear infinite;
        }

        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0deg);
            }

            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* Add animation to "page content" */

        .animate-bottom {
            position: relative;
            -webkit-animation-name: animatebottom;
            -webkit-animation-duration: 1s;
            animation-name: animatebottom;
            animation-duration: 1s
        }

        @-webkit-keyframes animatebottom {
            from {
                bottom: -100px;
                opacity: 0
            }

            to {
                bottom: 0px;
                opacity: 1
            }
        }

        @keyframes animatebottom {
            from {
                bottom: -100px;
                opacity: 0
            }

            to {
                bottom: 0;
                opacity: 1
            }
        }

        #printing {

            text-align: center;
        }


        .highcharts-figure,
        .highcharts-data-table table {
            min-width: 360px;
            max-width: 1600px;
            max-height: 800px;
            margin: 1em auto;
        }

        .highcharts-data-table table {
            font-family: Verdana, sans-serif;
            border-collapse: collapse;
            border: 1px solid #EBEBEB;
            margin: 10px auto;
            text-align: center;
            width: 100%;
            max-width: 500px;
        }

        .highcharts-data-table caption {
            padding: 1em 0;
            font-size: 1.2em;
            color: #555;
        }

        .highcharts-data-table th {
            font-weight: 600;
            padding: 0.5em;
        }

        .highcharts-data-table td,
        .highcharts-data-table th,
        .highcharts-data-table caption {
            padding: 0.5em;
        }

        .highcharts-data-table thead tr,
        .highcharts-data-table tr:nth-child(even) {
            background: #f8f8f8;
        }

        .highcharts-data-table tr:hover {
            background: #f1f7ff;
        }
    </style>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" type="text/javascript"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>

    <script src="https://code.highcharts.com/maps/highmaps.js"></script>
    <script src="https://code.highcharts.com/maps/modules/map.js"></script>
    <script src="https://code.highcharts.com/maps/modules/data.js"></script>
    <script src="https://code.highcharts.com/maps/modules/offline-exporting.js"></script>
    <script src="https://code.highcharts.com/mapdata/custom/world.js"></script>
</head>

<body>
    <a id="dlink" style="display:none;"></a>
    <!-- <button type="button" class="btn btn-primary btn-sm" style="vertical-align: middle;"
        onclick="printContent('state')"><span class="glyphicon glyphicon-print" style="font-size: 15px;"></span>
        &nbsp;
        Print
    </button> -->

    <button type="button" class="btn btn-success btn-sm" style="vertical-align: middle;" id="btnExport"
        onclick="tableToExcel('state', 'WER report', 'WER report')"><span class="glyphicon glyphicon-download-alt"
            style="font-size: 15px;"></span>Download As Excel</button>

    <button type="button" class="btn btn-success btn-sm" style="vertical-align: middle;" id="btnExport"
        onclick="tableToExcel('state', 'WER report', 'WER report.doc')"><span class="glyphicon glyphicon-download-alt"
            style="font-size: 15px;"></span>Download As Word</button>


    <div id="loader" style="display: none"></div>
    <div id="printing" class="animate-bottom">

        <div style="width: 50%; margin-left:25%;">
            <table class="table table-borderless table-striped">
                <tr>
                    <td style="font-size: 15px;padding-top: 15px;">
                        <label for="period-year">Select Year : </strong>
                    </td>
                    <td style="width: 60%;">
                        <select class="form-control" id="period-year" onchange="submitData()" style="cursor: pointer;">
                            <option hidden selected>Please select a year</option>
                        </select>
                    </td>
            </table>
        </div>
        <div id='state' style="display: none;padding:10px">
            <table border="1" id="dataTableFirst" class="table  table-hover text-center" cellspacing="6" cellpadding="4"
                style="border-collapse: collapse; text-align: center">
                <thead id="tableHeadFirst">
                    <tr style=" text-align:center;">
                        <td colspan="5"
                            style="font-weight:400; border-bottom:5px solid white; background: rgb(39, 102, 150);font-size:20px; color:white">
                            Table 1. Registered Prevalence at the end of <span id="tableYearPrevFirst"></span> and new
                            case
                            detection during <span id="tableYearFirstEnglish"></span>, by WHO
                            Region <br />
                            Tableau 1. Prévalence enregistrée de la lèpre et nombre de nouveaux cas dépistés, par Région
                            OMS
                            en <span id="tableYearFirstFrench"></span>
                        </td>
                    </tr>

                    <tr>
                        <td style="border:1px solid black; font-weight:600; background:#f2f2f2">WHO Region – Région OMS
                        </td>
                        <td style="border:1px solid black; font-weight:600; background:#f2f2f2">Total Cases registered
                            at
                            the end of year<br />Nombre de cas enregistrés</td>
                        <td style="border:1px solid black; font-weight:600; background:#f2f2f2">Prevalence rate (Per
                            million
                            population)<br /> (prévalence/ 10 000 habitants)
                        </td>
                        <td style="border:1px solid black; font-weight:600; background:#f2f2f2">Total cases<br /> Nombre
                            de
                            nouveaux cas dépistés</td>
                        <td style="border:1px solid black; font-weight:600; background:#f2f2f2">Case detection rate (Per
                            million population)<br /> Taux de dépistage des nouveaux cas/100 000 habitants) </td>
                    </tr>
                </thead>
                <tbody id="tableBodyFirst"></tbody>
            </table> <br />

            <table border="1" id="dataTableSecond" class="table  table-hover text-center" cellspacing="6"
                cellpadding="4" style="border-collapse: collapse; text-align: center">
                <thead>
                    <tr style=" text-align:center;">
                        <td colspan="11"
                            style="font-weight:400; border-bottom:5px solid white; background: rgb(39, 102, 150);font-size:20px; color:white">
                            Table 2 Trends in the detection of new cases of leprosy, by WHO Region, <span
                                id="tableYearSecondEnglish"></span><br />
                            Tableau 2 Tendances observées dans le dépistage de nouveaux cas de lèpre, par Région OMS,
                            en <span id="tableYearSecondFrench"></span>
                        </td>
                    </tr>
                    <tr id="tableHeadSecond"></tr>
                </thead>
                <tbody id="tableBodySecond"></tbody>
            </table> <br />

            <table border="1" id="dataTableThird" class="table  table-hover text-center" cellspacing="6" cellpadding="4"
                style="border-collapse: collapse; text-align: center">
                <thead>
                    <tr style=" text-align:center;">
                        <td colspan="11"
                            style="font-weight:400; border-bottom:5px solid white; background: rgb(39, 102, 150);font-size:20px; color:white">
                            Table 3 New case detection trends in 23 global priority countries for the past 10
                            years<br />
                            Tableau 3 Nouvelles tendances en matière de dépistage des cas dans 23 pays prioritaires du
                            monde
                            au cours des 10 dernières années
                        </td>
                    </tr>
                    <tr id="tableHeadThird"></tr>
                </thead>
                <tbody id="tableBodyThird"></tbody>
            </table> <br />

            <table border="1" id="dataTableFourth" class="table  table-hover text-center" cellspacing="6"
                cellpadding="4" style="border-collapse: collapse; text-align: center">
                <thead>
                    <tr style=" text-align:center;">
                        <td colspan="11"
                            style="font-weight:400; border-bottom:5px solid white; background: rgb(39, 102, 150);font-size:20px; color:white">
                            Table 4. Trends in number of new cases with G2D, by WHO region, <span
                                id="tableYearFourthEnglish"></span><br />
                            Tableau 4. Tendance en nombre de nouveaux cas depistes avec incapacité de degré 2, par
                            Région
                            OMS, <span id="tableYearFourthFrench"></span>
                        </td>
                    </tr>
                    <tr id="tableHeadFourth"></tr>
                </thead>
                <tbody id="tableBodyFourth"></tbody>
            </table> <br />

            <table border="1" id="dataTableFifth" class="table  table-hover text-center" cellspacing="6" cellpadding="4"
                style="border-collapse: collapse; text-align: center">
                <thead>
                    <tr style=" text-align:center;">
                        <td colspan="6"
                            style="font-weight:400; border-bottom:5px solid white; background: rgb(39, 102, 150);font-size:20px; color:white">
                            Table 5. Trends in new cases with G2D in 23 global priority countries, <span
                                id="tableYearFifthEnglish"></span> <br />
                            Tableau 5. Tendances des nouveaux cas de G2D dans 23 pays prioritaires, <span
                                id="tableYearFifthFrench"></span>
                        </td>
                    </tr>
                    <tr id="tableHeadFifth"></tr>
                </thead>
                <tbody id="tableBodyFifth"></tbody>
            </table> <br />

            <table border="1" id="dataTableSixth" class="table  table-hover text-center" cellspacing="6" cellpadding="4"
                style="border-collapse: collapse; text-align: center">
                <thead>
                    <tr style=" text-align:center;">
                        <td colspan="6"
                            style="font-weight:400; border-bottom:5px solid white; background: rgb(39, 102, 150);font-size:20px; color:white">
                            Table 6. Trends in new child cases in 23 global priority countries, <span
                                id="tableYearSixthEnglish"></span> <br />
                            Tableau 6. Tendances des nouveaux cas d'enfants dans 23 pays prioritaires, <span
                                id="tableYearSixthFrench"></span>
                        </td>
                    </tr>
                    <tr id="tableHeadSixth"></tr>
                </thead>
                <tbody id="tableBodySixth"></tbody>
            </table>

            <figure class="highcharts-figure">
                <div id="highCharts_first" style="height: 600px"></div>
                <div id="highCharts_second" style="height: 500px"></div>
                <div id="highCharts_third" style="height: 600px"></div>
                <div id="highCharts_fourth" style="height: 500px"></div>
                <div id="highCharts_fifth" style="height: 600px"></div>
                <div id="highCharts_sixth" style="height: 600px"></div>
                <div id="highCharts_seventh" style="height: 600px"></div>
                <div id="highCharts_Eighth" style="height: 600px"></div>
                <div id="highCharts_Twelfth" style="height: 600px"></div>
            </figure>
        </div>
    </div>
    <script>

        var date = new Date();
        var currentYear = date.getFullYear();
        for (i = currentYear; i >= 2015; i--)  document.getElementById("period-year").innerHTML += `<option value=${i}>${i}</option>`

        function submitData() {
            document.getElementById("state").style.display = "none";
            document.getElementById("loader").style.display = "block";
            var assignValue = (headerId, value) => document.getElementById(headerId).innerHTML = value;

            var generateHeaderRow = (headerId, period, headerOpt) => {
                document.getElementById(headerId).innerHTML = `<td style="border:1px solid black; font-weight:600; background:#f2f2f2;text-align:left">${(headerOpt ? `WHO Region – Région OMS` : `Country – Pays`)}</td>`
                period.forEach(p => {
                    document.getElementById(headerId).innerHTML += `<td style="border:1px solid black; font-weight:600; background:#f2f2f2">${p}</td>`
                })
            }

            var getYear = (currentYear, yearsBack) => {
                let arrYear = [];
                while (yearsBack != 0) {
                    arrYear.push(currentYear);
                    currentYear--;
                    yearsBack--;
                }
                return arrYear.reverse();
            }

            var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            var abbreviatedNames = {
                "L9CbxlithLc": "AFR",
                "uWVIlmAl1r5": "AMR",
                "XHT7CFb5mEe": "EMR",
                "UzbbopOhq1L": "EUR",
                "vY40CQrh4Kk": "SEAR",
                "QvCHetFovQg": "WPR",
                "x3i5oi4axNu": "World"
            }
            var printTotalThird = [], printTotalFifth = [], printTotalSixth = [];
            var trendG2CasesChild, trendG2Cases = [], leprorsyThreeCases = [], LeprosyFourCases = [], LeprosyTotalCases = [];
            var trendG2CasesChildPie = [{
                name: 'Number of countries reporting 0 child grade 2 disability cases',
                value: "0",
                y: 0,
                sliced: true,
                selected: true
            }, {
                name: 'Number of countries reporting 1-9 child grade 2 disability cases',
                value: "1-9",
                y: 0,

            }, {
                name: 'Number of countries reporting 10-99 child grade 2 disability cases',
                value: '10-99',
                y: 0,

            }, {
                name: 'Number of countries reporting >99 child grade 2 disability cases',
                value: ">99",
                y: 0,

            }];
            var trendG2CasesPie = [{
                name: 'Number of countries reporting <1 grade 2 disability rate per million population',
                value: "<1",
                y: 0,
                sliced: true,
                selected: true
            }, {
                name: 'Number of countries reporting 1-9 grade 2 disability rate per million population',
                value: "1-9",
                y: 0,

            }, {
                name: 'Number of countries reporting >9 grade 2 disability rate per million population',
                value: ">9",
                y: 0,

            }]
            var globalTotalThird = [], globalTotalFifth = [], globalTotalSixth = [], globalTotalSeventh = 0, globalTotalEighth = [];
            for (var i = 0; i <= 10; i++) {
                printTotalThird[i] = 0;
                printTotalFifth[i] = 0;
                printTotalSixth[i] = 0;
                globalTotalThird[i] = 0;
                globalTotalFifth[i] = 0;
                globalTotalSixth[i] = 0;
                globalTotalEighth[i] = 0;
            }
            var selectedPeriod = document.getElementById("period-year").value;

            let valueYear;
            var dataElementIdFirst = ["YgvbZE63e8T", "sAXV6Hnve4i", "gY7b9azcUQG", "ElAjdwOrjMq"];
            var orgUnitIdFirst = ["L9CbxlithLc", "uWVIlmAl1r5", "XHT7CFb5mEe", "vY40CQrh4Kk", "QvCHetFovQg", "UzbbopOhq1L", "x3i5oi4axNu"];
            var idFirst = `../../analytics.json?dimension=dx:${dataElementIdFirst.join(";")}&dimension=ou:${orgUnitIdFirst.join(";")}&filter=pe:${selectedPeriod}&displayProperty=NAME`;

            assignValue('tableYearPrevFirst', selectedPeriod - 1)
            assignValue('tableYearFirstEnglish', selectedPeriod)
            assignValue('tableYearFirstFrench', selectedPeriod)

            var orgUnitIdSecond = ["L9CbxlithLc", "uWVIlmAl1r5", "XHT7CFb5mEe", "vY40CQrh4Kk", "QvCHetFovQg", "UzbbopOhq1L", "x3i5oi4axNu"];
            var selectedPeriodSecond = getYear(selectedPeriod, 10);
            var idSecond = `../../analytics.json?dimension=dx:gY7b9azcUQG&dimension=pe:${selectedPeriodSecond.join(";")}&dimension=ou:${orgUnitIdSecond.join(";")}&displayProperty=NAME`;

            generateHeaderRow("tableHeadSecond", selectedPeriodSecond, true);
            assignValue('tableYearSecondEnglish', `${selectedPeriod - 9} - ${selectedPeriod}`)
            assignValue('tableYearSecondFrench', `${selectedPeriod - 9} - ${selectedPeriod}`)

            var selectedPeriodThird = getYear(selectedPeriod, 10);
            generateHeaderRow("tableHeadThird", selectedPeriodThird, false);
            var idThird = `../../analytics.json?dimension=UcYmwOmalCR:gTofFxvbRSI&dimension=dx:gY7b9azcUQG&dimension=pe:${selectedPeriodThird.join(";")}&dimension=ou:USER_ORGUNIT_GRANDCHILDREN&displayProperty=NAME&user=z7Gac7vahQL`;

            var orgUnitIdFourth = ["L9CbxlithLc", "uWVIlmAl1r5", "XHT7CFb5mEe", "vY40CQrh4Kk", "QvCHetFovQg", "UzbbopOhq1L", "x3i5oi4axNu"];
            var selectedPeriodFourth = getYear(selectedPeriod, 10);
            var idFourth = `../../analytics.json?dimension=dx:cyg9FDI48hW&dimension=pe:${selectedPeriodFourth.join(";")}&dimension=ou:${orgUnitIdFourth.join(";")}&displayProperty=NAME`;

            generateHeaderRow("tableHeadFourth", selectedPeriodFourth, true);
            assignValue('tableYearFourthEnglish', `${selectedPeriod - 9} - ${selectedPeriod}`)
            assignValue('tableYearFourthFrench', `${selectedPeriod - 9} - ${selectedPeriod}`)

            var selectedPeriodFifth = getYear(selectedPeriod, 5);
            generateHeaderRow("tableHeadFifth", selectedPeriodFifth, false)
            var idFifth = `../../analytics.json?dimension=UcYmwOmalCR:gTofFxvbRSI&dimension=dx:cyg9FDI48hW&dimension=pe:${selectedPeriodFifth.join(";")}&dimension=ou:USER_ORGUNIT_GRANDCHILDREN&displayProperty=NAME&user=z7Gac7vahQL`;

            generateHeaderRow("tableHeadFourth", selectedPeriodFourth);
            assignValue('tableYearFifthEnglish', `${selectedPeriod - 4} - ${selectedPeriod}`)
            assignValue('tableYearFifthFrench', `${selectedPeriod - 4} - ${selectedPeriod}`)

            var selectedPeriodSixth = getYear(selectedPeriod, 5);
            generateHeaderRow("tableHeadSixth", selectedPeriodSixth, false)
            var idSixth = `../../analytics.json?dimension=UcYmwOmalCR:gTofFxvbRSI&dimension=dx:PS9m9ERoPaj&dimension=pe:${selectedPeriodSixth.join(";")}&dimension=ou:USER_ORGUNIT_GRANDCHILDREN&displayProperty=NAME&user=z7Gac7vahQL`;

            var selectedPeriodSeventh = getYear(selectedPeriod, 5);
            var idSeventh = `../../analytics.json?dimension=dx:vDXU1FdXPHz&dimension=pe:${selectedPeriodSeventh.join(";")}&dimension=ou:USER_ORGUNIT_GRANDCHILDREN&displayProperty=NAME&user=z7Gac7vahQL`;

            var selectedPeriodEighth = getYear(selectedPeriod, 5);
            var idEighth = `../../analytics.json?dimension=dx:v1Fr4On014j&dimension=pe:${selectedPeriodEighth.join(";")}&dimension=ou:USER_ORGUNIT_GRANDCHILDREN&displayProperty=NAME&user=z7Gac7vahQL`;

            var orgUnitGroup = "../../organisationUnitGroups/gTofFxvbRSI.json?fields=[name,organisationUnits]&paging=false"; //Global Priority Countries

            var globalTotalUrl = "../../analytics.json?dimension=dx:gY7b9azcUQG;cyg9FDI48hW;PS9m9ERoPaj&dimension=ou:x3i5oi4axNu&dimension=pe:" + getYear(selectedPeriod, 10).join(";") + "&displayProperty=NAME";

            var selectedPeriodNinth = getYear(selectedPeriod, 10);
            var dataElementIdNinth = ["gY7b9azcUQG", "PS9m9ERoPaj", "cyg9FDI48hW"]
            var idNinth = `../../analytics.json?dimension=dx:gY7b9azcUQG;PS9m9ERoPaj;cyg9FDI48hW&dimension=pe:${selectedPeriodNinth.join(";")}&filter=ou:USER_ORGUNIT&displayProperty=NAME&user=z7Gac7vahQL&paging=false`;

            var dataElementIdTenth = ["gY7b9azcUQG", "PS9m9ERoPaj", "ElAjdwOrjMq", "SsZP6Izyhay"]
            var idTenth = `../../analytics.json?dimension=dx:${dataElementIdTenth.join(";")}&dimension=pe:${selectedPeriodNinth.join(";")}&filter=ou:USER_ORGUNIT&displayProperty=NAME&user=z7Gac7vahQL&paging=false`;

            var orgUnitIdEleventh = ["L9CbxlithLc", "uWVIlmAl1r5", "XHT7CFb5mEe", "UzbbopOhq1L", "vY40CQrh4Kk", "QvCHetFovQg", "x3i5oi4axNu"]
            var idEleventh = `../../analytics.json?dimension=ou:${orgUnitIdEleventh.join(";")}&dimension=pe:${selectedPeriodNinth.join(";")}&filter=dx:gY7b9azcUQG&displayProperty=NAME&user=z7Gac7vahQL&paging=false`;

            var idTwelfth = `../../analytics.json?dimension=pe:${selectedPeriod}&dimension=dx:gY7b9azcUQG&dimension=ou:USER_ORGUNIT_GRANDCHILDREN&displayProperty=NAME&paging=false`;

            var organisationUnitName = [];
            var organisationUnitCode = [];

            $.ajax({
                type: "GET",
                async: false,
                url: "../../organisationUnits/x3i5oi4axNu.json?fields=children[id,name,children[id,name,code],code]",
                data: JSON,
                success: function (orgUnit) {
                    orgUnit.children.sort((a, b) => a.name.localeCompare(b.name));
                    orgUnit.children.forEach(orgUnits => orgUnits.children.forEach(ou => {
                        organisationUnitCode[ou.id] = (ou.code ? ou.code : "")
                        organisationUnitName[ou.id] = (ou.name ? ou.name : "")
                    }))
                }
            })

            $.when(
                $.get(idFirst),
                $.get(idSecond),
                $.get(idThird),
                $.get(idFourth),
                $.get(idFifth),
                $.get(idSixth),
                $.get(orgUnitGroup),
                $.get(globalTotalUrl),
                $.get(idSeventh),
                $.get(idEighth),
                $.get(idNinth),
                $.get(idTenth),
                $.get(idEleventh),
                $.get(idTwelfth),
            ).done(function (rowFirst, rowSecond, rowThird, rowFourth, rowFifth, rowSixth, GlobalPriorityCountries, globalTotalVlaues, rowSeventh, rowEighth, rowNinth, rowTenth, rowEleventh, rowTwelfth) {

                rowFirst = rowFirst["0"];
                rowSecond = rowSecond["0"];
                rowThird = rowThird["0"];
                rowFourth = rowFourth["0"];
                rowFifth = rowFifth["0"];
                rowSixth = rowSixth["0"];
                rowSeventh = rowSeventh["0"];
                rowEighth = rowEighth["0"];
                globalTotalVlaues = globalTotalVlaues["0"];
                GlobalPriorityCountries = GlobalPriorityCountries["0"].organisationUnits;
                rowNinth = rowNinth["0"];
                rowTenth = rowTenth["0"];
                rowEleventh = rowEleventh["0"];
                rowTwelfth = rowTwelfth["0"];

                let dataFirst = [], dataSecond = [], dataThird = []; dataFourth = [], dataFifth = [], dataSixth = [], globalTotal = [], dataSeventh = [], dataEighth = [], dataNinth = [], dataTenth = [], dataEleventh = [], dataTwelfth = [];
                let metadataValues = [];

                for (let id in rowFirst.metaData.items) {
                    metadataValues[id] = rowFirst.metaData.items[id].name;
                }
                for (let id in rowThird.metaData.items) {
                    metadataValues[id] = rowThird.metaData.items[id].name;
                }
                gpc = GlobalPriorityCountries.map(gpc => {
                    gpc["name"] = metadataValues[gpc.id] ? metadataValues[gpc.id] : ""
                    return gpc;
                }).sort((a, b) => a.name.localeCompare(b.name));

                rowFirst.rows.forEach(row => {
                    if (!dataFirst[row["1"]]) {
                        dataFirst[row["1"]] = [];
                        dataFirst[row["1"]][row["0"]] = Number(row["2"]);
                    } else {
                        dataFirst[row["1"]][row["0"]] = Number(row["2"]);
                    }
                })

                rowSecond.rows.forEach(row => {
                    if (!dataSecond[row["2"]]) {
                        dataSecond[row["2"]] = [];
                        dataSecond[row["2"]][row["1"]] = Number(row["3"]);
                    } else {
                        dataSecond[row["2"]][row["1"]] = Number(row["3"]);
                    }
                })

                rowThird.rows.forEach(row => {
                    if (!dataThird[row["3"]]) {
                        dataThird[row["3"]] = [];
                        dataThird[row["3"]][row["2"]] = Number(row["4"]);
                    } else {
                        dataThird[row["3"]][row["2"]] = Number(row["4"]);
                    }
                })

                rowFourth.rows.forEach(row => {
                    if (!dataFourth[row["2"]]) {
                        dataFourth[row["2"]] = [];
                        dataFourth[row["2"]][row["1"]] = Number(row["3"]);
                    } else {
                        dataFourth[row["2"]][row["1"]] = Number(row["3"]);
                    }
                })

                rowFifth.rows.forEach(row => {
                    if (!dataFifth[row["3"]]) {
                        dataFifth[row["3"]] = [];
                        dataFifth[row["3"]][row["2"]] = Number(row["4"]);
                    } else {
                        dataFifth[row["3"]][row["2"]] = Number(row["4"]);
                    }
                })

                rowSixth.rows.forEach(row => {
                    if (!dataSixth[row["3"]]) {
                        dataSixth[row["3"]] = [];
                        dataSixth[row["3"]][row["2"]] = Number(row["4"]);
                    } else {
                        dataSixth[row["3"]][row["2"]] = Number(row["4"]);
                    }
                })

                rowSeventh.rows.forEach(row => {
                    if (Number(row["3"]) == 0) {
                        if (!dataSeventh[row["1"]]) {
                            dataSeventh[row["1"]] = 1;
                        } else {
                            dataSeventh[row["1"]] += 1;
                        }
                    }
                })
                rowSeventh.rows.forEach(row => {
                    if (Number(row["1"]) == selectedPeriod) {
                        if (Number(row["3"]) == 0) trendG2CasesChildPie["0"].y += 1;
                        if (Number(row["3"]) >= 1 && Number(row["3"] <= 9)) trendG2CasesChildPie["1"].y += 1;
                        if (Number(row["3"]) >= 10 && Number(row["3"] <= 99)) trendG2CasesChildPie["2"].y += 1;
                        if (Number(row["3"]) > 99) trendG2CasesChildPie["3"].y += 1;

                    }
                })
                let keys = Object.keys(dataSeventh).sort();
                trendG2CasesChild = keys.map(key => (dataSeventh[key]) ? dataSeventh[key] : 0);

                rowEighth.rows.forEach(row => {
                    if (Number(row["3"]) < 1) {
                        if (!dataEighth[row["1"]]) {
                            dataEighth[row["1"]] = [];
                            dataEighth[row["1"]]["0"] = 1;
                        } else {
                            if (!dataEighth[row["1"]]["0"]) dataEighth[row["1"]]["0"] = 0;
                            dataEighth[row["1"]]["0"] += 1;
                        }
                    } else {
                        if (!dataEighth[row["1"]]) {
                            dataEighth[row["1"]] = [];
                            dataEighth[row["1"]]["1"] = 1;
                        } else {
                            if (!dataEighth[row["1"]]["1"]) dataEighth[row["1"]]["1"] = 0
                            dataEighth[row["1"]]["1"] += 1;
                        }
                    }
                })

                keys = Object.keys(dataEighth).sort();
                trendG2Cases.push({ name: "Number of countries reporting <1 grade 2 disability rate per million population", data: [] })
                trendG2Cases.push({ name: "Number of countries reporting >=1 grade 2 disability rate per million population", data: [] })
                keys.forEach(key => {
                    if (dataSeventh[key]) {
                        trendG2Cases["0"].data.push(((dataEighth[key]["0"]) ? dataEighth[key]["0"] : 0))
                        trendG2Cases["1"].data.push(((dataEighth[key]["1"]) ? dataEighth[key]["1"] : 0))
                    }
                });

                rowEighth.rows.forEach(row => {
                    if (Number(row["1"]) == selectedPeriod) {
                        if (Number(row["3"]) < 1) trendG2CasesPie["0"].y += 1;
                        if (Number(row["3"]) >= 1 && Number(row["3"] <= 9)) trendG2CasesPie["1"].y += 1;
                        if (Number(row["3"]) > 9) trendG2CasesPie["2"].y += 1;
                    }
                });

                rowNinth.rows.forEach(row => {
                    if (!dataNinth[row["0"]]) {
                        dataNinth[row["0"]] = [];
                        dataNinth[row["0"]][row["1"]] = Number(row["2"]);
                    }
                    else {
                        dataNinth[row["0"]][row["1"]] = Number(row["2"]);
                    }
                })

                dataElementIdNinth.forEach((key, indexFirst) => {
                    leprorsyThreeCases[indexFirst] = [];
                    selectedPeriodNinth.forEach((period, indexSecond) => {
                        leprorsyThreeCases[indexFirst][indexSecond] = dataNinth[key][period] ? dataNinth[key][period] : 0;
                    })
                });

                rowTenth.rows.forEach(row => {
                    if (!dataTenth[row["0"]]) {
                        dataTenth[row["0"]] = [];
                        dataTenth[row["0"]][row["1"]] = Number(row["2"]);
                    }
                    else {
                        dataTenth[row["0"]][row["1"]] = Number(row["2"]);
                    }
                })

                dataElementIdTenth.forEach((key, indexFirst) => {
                    LeprosyFourCases[indexFirst] = [];
                    selectedPeriodNinth.forEach((period, indexSecond) => {
                        LeprosyFourCases[indexFirst][indexSecond] = dataTenth[key][period] ? dataTenth[key][period] : 0;
                    })
                })

                rowEleventh.rows.forEach(row => {
                    if (!dataEleventh[row["0"]]) {
                        dataEleventh[row["0"]] = [];
                        dataEleventh[row["0"]][row["1"]] = Number(row["2"]);
                    }
                    else {
                        dataEleventh[row["0"]][row["1"]] = Number(row["2"]);
                    }
                })

                orgUnitIdEleventh.forEach((key, indexFirst) => {
                    LeprosyTotalCases[indexFirst] = {
                        type: key == "x3i5oi4axNu" ? 'line' : 'column',
                        name: (abbreviatedNames[key] ? abbreviatedNames[key] : metadataValues[key]),
                        data: []
                    }

                    selectedPeriodNinth.forEach((period, indexSecond) => {
                        LeprosyTotalCases[indexFirst]["data"][indexSecond] = dataEleventh[key][period] ? dataEleventh[key][period] : 0;
                    })
                })

                globalTotalVlaues.rows.forEach(row => {
                    if (!globalTotal[row["2"]]) {
                        globalTotal[row["2"]] = [];
                        globalTotal[row["2"]][row["0"]] = Number(row["3"]);
                    } else {
                        globalTotal[row["2"]][row["0"]] = Number(row["3"]);
                    }
                })

                let rowCheck = [];
                rowTwelfth.rows.forEach(row => {
                    if (!rowCheck[row["2"]]) {
                        rowCheck[row["2"]] = true;
                        dataTwelfth.push({
                            code: organisationUnitCode[row["2"]].toUpperCase(),
                            value: Number(row["3"]),
                            name: organisationUnitName[row["2"]]
                        })
                    }
                })


                var tableRow = ""
                for (let orgUnitId of orgUnitIdFirst) {
                    tableRow += "<tr><td style='text-align:left;font-weight:400;'>" + metadataValues[orgUnitId] + "</td>"
                    dataElementIdFirst.forEach((element, index) => {
                        tableRow += "<td style='font-weight:400'>" + (dataFirst[orgUnitId] ? (dataFirst[orgUnitId][element] ? dataFirst[orgUnitId][element] : (dataFirst[orgUnitId][element] == 0 ? 0 : "")) : "") + "</td>"
                    });
                    tableRow += "<tr>";
                }
                document.getElementById("tableBodyFirst").innerHTML = tableRow;

                tableRow = ""
                for (let orgUnitId of orgUnitIdSecond) {
                    tableRow += "<tr><td style='text-align:left;font-weight:400;'>" + metadataValues[orgUnitId] + "</td>"
                    selectedPeriodSecond.forEach((period, index) => {
                        tableRow += "<td style='font-weight:400'>" + (dataSecond[orgUnitId] ? (dataSecond[orgUnitId][period] ? dataSecond[orgUnitId][period] : (dataSecond[orgUnitId][period] == 0 ? 0 : "")) : "") + "</td>"
                    });
                    tableRow += "<tr>";
                }
                document.getElementById("tableBodySecond").innerHTML = tableRow;

                tableRow = ""
                for (let orgUnitId of gpc) {
                    tableRow += "<tr><td style='text-align:left;font-weight:400;'>" + metadataValues[orgUnitId.id] + "</td>"
                    selectedPeriodThird.forEach((period, index) => {
                        tableRow += "<td style='font-weight:400'>" + (dataThird[orgUnitId.id] ? (dataThird[orgUnitId.id][period] ? dataThird[orgUnitId.id][period] : (dataThird[orgUnitId.id][period] == 0 ? 0 : "")) : "") + "</td>"
                        printTotalThird[index] += (dataThird[orgUnitId.id] ? (dataThird[orgUnitId.id][period] ? dataThird[orgUnitId.id][period] : 0) : 0);
                        globalTotalThird[index] = globalTotal[period] ? (globalTotal[period]["gY7b9azcUQG"] ? globalTotal[period]["gY7b9azcUQG"] : 0) : 0;
                    });
                    tableRow += "<tr>";
                }

                tableRow += "<tr><td style='text-align:left;font-weight:600;'>New cases in global priority countries</td>"
                for (let i = 0; i < 10; i++)  tableRow += "<td style='font-weight:600'>" + printTotalThird[i] + "</td>";
                tableRow += "<tr>";
                tableRow += "<tr><td style='text-align:left;font-weight:600;'>Proportion (%) of total cases</td>"
                for (let i = 0; i < 10; i++)  tableRow += "<td style='font-weight:600'>" + (((printTotalThird[i] / globalTotalThird[i]) != Infinity && (printTotalThird[i] / globalTotalThird[i])) ? ((printTotalThird[i] / globalTotalThird[i] * 100).toFixed("2") + "%") : "") + "</td>";
                tableRow += "<tr>";
                tableRow += "<tr><td style='text-align:left;font-weight:600;'>Global Total</td>"
                for (let i = 0; i < 10; i++)  tableRow += "<td style='font-weight:600'>" + globalTotalThird[i] + "</td>";
                tableRow += "<tr>";

                document.getElementById("tableBodyThird").innerHTML = tableRow;

                tableRow = ""
                for (let orgUnitId of orgUnitIdFourth) {
                    tableRow += "<tr><td style='text-align:left;font-weight:400;'>" + metadataValues[orgUnitId] + "</td>"
                    selectedPeriodFourth.forEach((period, index) => {
                        tableRow += "<td style='font-weight:400'>" + (dataFourth[orgUnitId] ? (dataFourth[orgUnitId][period] ? dataFourth[orgUnitId][period] : (dataFourth[orgUnitId][period] == 0 ? 0 : "")) : "") + "</td>"
                    });
                    tableRow += "<tr>";
                }
                document.getElementById("tableBodyFourth").innerHTML = tableRow;

                tableRow = ""
                for (let orgUnitId of gpc) {
                    tableRow += "<tr><td style='text-align:left;font-weight:400;'>" + metadataValues[orgUnitId.id] + "</td>"
                    selectedPeriodFifth.forEach((period, index) => {
                        tableRow += "<td style='font-weight:400'>" + (dataFifth[orgUnitId.id] ? (dataFifth[orgUnitId.id][period] ? dataFifth[orgUnitId.id][period] : (dataFifth[orgUnitId.id][period] == 0 ? 0 : "")) : "") + "</td>"
                        printTotalFifth[index] += (dataFifth[orgUnitId.id] ? (dataFifth[orgUnitId.id][period] ? dataFifth[orgUnitId.id][period] : 0) : 0)
                        globalTotalFifth[index] = globalTotal[period] ? (globalTotal[period]["cyg9FDI48hW"] ? globalTotal[period]["cyg9FDI48hW"] : 0) : 0;
                    });
                    tableRow += "<tr>";
                }
                
                tableRow += "<tr><td style='text-align:left;font-weight:600;'>Number of new cases with G2D in global priority countries</td>"
                for (let i = 0; i < 5; i++)  tableRow += "<td style='font-weight:600'>" + printTotalFifth[i] + "</td>";
                tableRow += "<tr>";
                tableRow += "<tr><td style='text-align:left;font-weight:600;'>Proportion (%) of total new cases with G2D in global priority countries </td>"
                for (let i = 0; i < 5; i++)  tableRow += "<td style='font-weight:600'>" + (((printTotalFifth[i] / globalTotalFifth[i]) != Infinity && (printTotalFifth[i] / globalTotalFifth[i])) ? ((printTotalFifth[i] / globalTotalFifth[i] * 100).toFixed("2") + "%") : "") + "</td>";
                tableRow += "<tr>";
                tableRow += "<tr><td style='text-align:left;font-weight:600;'>Global total new cases with G2D </td>"
                for (let i = 0; i < 5; i++)  tableRow += "<td style='font-weight:600'>" + globalTotalFifth[i] + "</td>";
                tableRow += "<tr>";

                document.getElementById("tableBodyFifth").innerHTML = tableRow;

                tableRow = ""
                for (let orgUnitId of gpc) {
                    tableRow += "<tr><td style='text-align:left;font-weight:400;'>" + metadataValues[orgUnitId.id] + "</td>"
                    selectedPeriodSixth.forEach((period, index) => {
                        tableRow += "<td style='font-weight:400'>" + (dataSixth[orgUnitId.id] ? (dataSixth[orgUnitId.id][period] ? dataSixth[orgUnitId.id][period] : (dataSixth[orgUnitId.id][period] == 0 ? 0 : "")) : "") + "</td>"
                        printTotalSixth[index] += (dataSixth[orgUnitId.id] ? (dataSixth[orgUnitId.id][period] ? dataSixth[orgUnitId.id][period] : 0) : 0)
                        globalTotalSixth[index] = globalTotal[period] ? (globalTotal[period]["PS9m9ERoPaj"] ? globalTotal[period]["PS9m9ERoPaj"] : 0) : 0;
                    });
                    tableRow += "<tr>";
                }

                tableRow += "<tr><td style='text-align:left;font-weight:600;'>Number of new child cases in 23 g Global priority countries</td>"
                for (let i = 0; i < 5; i++)  tableRow += "<td style='font-weight:600'>" + printTotalSixth[i] + "</td>";
                tableRow += "<tr>";
                tableRow += "<tr><td style='text-align:left;font-weight:600;'>Proportion (%) of total new child cases in global priority countries</td>"
                for (let i = 0; i < 5; i++)  tableRow += "<td style='font-weight:600'>" + (((printTotalSixth[i] / globalTotalSixth[i]) != Infinity && (printTotalSixth[i] / globalTotalSixth[i])) ? ((printTotalSixth[i] / globalTotalSixth[i] * 100).toFixed("2") + "%") : "") + "</td>";
                tableRow += "<tr>";
                tableRow += "<tr><td style='text-align:left;font-weight:600;'>Global total new child cases  </td>"
                for (let i = 0; i < 5; i++)  tableRow += "<td style='font-weight:600'>" + globalTotalSixth[i] + "</td>";
                tableRow += "<tr>";

                document.getElementById("tableBodySixth").innerHTML = tableRow;

                document.getElementById("state").style.display = "block";
                document.getElementById("loader").style.display = "none";

                Highcharts.chart('highCharts_first', {
                    chart: {
                        type: 'line'
                    },
                    title: {
                        text: `Graph 1 : Trend - Countries reporting 0 child grade 2 disability cases - ${selectedPeriod - 4} - ${selectedPeriod}`
                    },

                    xAxis: {
                        categories: selectedPeriodSeventh,
                        accessibility: {
                            rangeDescription: `Range from ${selectedPeriod - 4} - ${selectedPeriod}`
                        }
                    },
                    yAxis: {
                        title: {
                            text: 'Number of Countries'
                        }
                    },
                    plotOptions: {
                        line: {
                            dataLabels: {
                                enabled: true
                            },
                        }
                    },
                    series: [{
                        name: 'Number of countries reporting 0 child grade 2 disability cases',
                        data: trendG2CasesChild,
                    }],
                    responsive: {
                        rules: [{
                            condition: {
                                maxWidth: 1500
                            },
                            chartOptions: {
                                legend: {
                                    layout: 'horizontal',
                                    align: 'center',
                                    verticalAlign: 'bottom'
                                }
                            }
                        }]
                    }

                });

                Highcharts.chart('highCharts_second', {
                    chart: {
                        plotBackgroundColor: null,
                        plotBorderWidth: null,
                        plotShadow: false,
                        type: 'pie'
                    },
                    title: {
                        text: `Graph 2 : Countries reporting child grade 2 disability cases - ${selectedPeriod}`
                    },
                    tooltip: {
                        pointFormat: '{series.value}: <b>{point.y} ({point.percentage:.2f} %)</b>'
                    },
                    plotOptions: {
                        pie: {
                            showInLegend: true,
                            allowPointSelect: true,
                            cursor: 'pointer',
                            dataLabels: {
                                enabled: true,
                                format: '<b>{point.value}</b>: {point.y} ({point.percentage:.2f} %)'
                            }
                        }
                    },
                    series: [{
                        name: 'Countries',
                        colorByPoint: true,
                        data: trendG2CasesChildPie
                    }]
                });

                // Highcharts.chart('highCharts_third', {
                //     chart: {
                //         type: 'line'
                //     },
                //     title: {
                //         text: `Graph 3 : Trend - Countries reporting <1 and >=1 grade 2 disability rate per million population -  ${selectedPeriod - 4} - ${selectedPeriod}`
                //     },
                //     xAxis: {
                //         categories: selectedPeriodEighth,
                //         accessibility: {
                //             rangeDescription: `Range from ${selectedPeriod - 4} - ${selectedPeriod}`
                //         },
                //     },
                //     yAxis: {
                //         title: {
                //             text: 'Number of Countries'
                //         }
                //     },
                //     plotOptions: {
                //         line: {
                //             dataLabels: {
                //                 enabled: true
                //             },
                //             enableMouseTracking: true
                //         }
                //     },
                //     series: trendG2Cases
                // });
                Highcharts.chart('highCharts_third', {
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: `Graph 3 : Trend - Countries reporting <1 and >=1 grade 2 disability rate per million population -  ${selectedPeriod - 4} - ${selectedPeriod}`
                    },
                    xAxis: {
                        categories: selectedPeriodEighth,
                        accessibility: {
                            rangeDescription: `Range from ${selectedPeriod - 4} - ${selectedPeriod}`
                        },
                    },
                    yAxis: {
                        title: {
                            text: 'Number of Countries'
                        }
                    },
                    plotOptions: {
                        line: {
                            dataLabels: {
                                enabled: true
                            },
                            enableMouseTracking: true
                        }
                    },
                    series: trendG2Cases
                });

                Highcharts.chart('highCharts_fourth', {
                    chart: {
                        plotBackgroundColor: null,
                        plotBorderWidth: null,
                        plotShadow: false,
                        type: 'pie'
                    },
                    title: {
                        text: `Graph 4 : Countries reporting <1 and >=1 grade 2 disability rate per million population - ${selectedPeriod}`
                    },
                    tooltip: {
                        pointFormat: '{series.value}: <b>{point.y} ({point.percentage:.2f} %)</b>'
                    },
                    plotOptions: {
                        pie: {
                            showInLegend: true,
                            allowPointSelect: true,
                            cursor: 'pointer',
                            dataLabels: {
                                enabled: true,
                                format: '<b>{point.value}</b>: {point.y} ({point.percentage:.2f} %)'
                            }
                        }
                    },
                    series: [{
                        name: 'Countries',
                        colorByPoint: true,
                        data: trendG2CasesPie
                    }]
                });

                Highcharts.chart('highCharts_fifth', {
                    chart: {
                        type: 'line'
                    },
                    title: {
                        text: `Graph 5 : Trend - Countries reporting <1 grade 2 disability rate per million population -  ${selectedPeriod - 4} - ${selectedPeriod}`
                    },

                    xAxis: {
                        categories: selectedPeriodSeventh,
                        accessibility: {
                            rangeDescription: `Range from ${selectedPeriod - 4} - ${selectedPeriod}`
                        }
                    },
                    yAxis: {
                        title: {
                            text: 'Number of Countries'
                        }
                    },
                    plotOptions: {
                        line: {
                            dataLabels: {
                                enabled: true
                            },
                        }
                    },
                    series: [trendG2Cases["0"]]

                });

                Highcharts.chart('highCharts_sixth', {

                    title: {
                        text: ''
                    },
                    xAxis: {
                        categories: selectedPeriodNinth,
                        accessibility: {
                            rangeDescription: `Range from  ${selectedPeriod - 15} - ${selectedPeriod}`
                        }
                    },
                    yAxis: [{
                        title: {
                            text: 'New leprosy cases',
                            style: {
                                color: Highcharts.getOptions().colors[0]
                            }
                        },
                        labels: {
                            style: {
                                color: Highcharts.getOptions().colors[0]
                            }
                        },
                    }, { // Secondary yAxis
                        title: {
                            text: 'New child cases & New G2D cases',
                            style: {
                                color: Highcharts.getOptions().colors[1]
                            }
                        },
                        opposite: true
                    }],

                    plotOptions: {
                        column: {
                            stacking: 'normal',
                            dataLabels: {
                                enabled: true,
                                color: "white"
                            }
                        },
                        line: {
                            dataLabels: {
                                enabled: true
                            },
                        }
                    },
                    series: [{
                        type: 'column',
                        name: 'New leprosy cases',
                        data: leprorsyThreeCases["0"]
                    },
                    {
                        type: 'line',
                        name: 'New child cases',
                        yAxis: 1,
                        data: leprorsyThreeCases["1"]
                    }, {
                        type: 'line',
                        name: 'New G2D cases',
                        yAxis: 1,
                        data: leprorsyThreeCases["2"]

                    }]

                });

                Highcharts.chart('highCharts_seventh', {

                    title: {
                        text: ''
                    },
                    xAxis: {
                        categories: selectedPeriodNinth,
                        accessibility: {
                            rangeDescription: `Range from  ${selectedPeriod - 10} - ${selectedPeriod}`
                        }
                    },
                    yAxis: [{
                        title: {
                            text: 'New leprosy cases',
                            style: {
                                color: Highcharts.getOptions().colors[0]
                            }
                        },
                        labels: {
                            style: {
                                color: Highcharts.getOptions().colors[0]
                            }
                        },
                    }, { // Secondary yAxis
                        title: {
                            text: 'Detection rate',
                            style: {
                                color: Highcharts.getOptions().colors[1]
                            }
                        },
                        opposite: true
                    }],

                    plotOptions: {
                        column: {
                            stacking: 'normal',
                            dataLabels: {
                                enabled: true,
                                color: 'white'
                            }
                        },
                        line: {
                            dataLabels: {
                                enabled: true
                            },
                        }
                    },
                    series: [{
                        type: 'column',
                        name: 'Total cases',
                        data: LeprosyFourCases["0"]
                    },
                    {
                        type: 'column',
                        name: 'New cases: Children',
                        data: LeprosyFourCases["1"]
                    },
                    {
                        type: 'line',
                        name: 'Case detection Rate (Per million population)',
                        yAxis: 1,
                        data: LeprosyFourCases["2"]
                    }, {
                        type: 'line',
                        name: 'Child case detection rate (Per million child population)',
                        yAxis: 1,
                        data: LeprosyFourCases["3"]

                    }]

                });
                Highcharts.chart('highCharts_Eighth', {

                    title: {
                        text: ''
                    },
                    xAxis: {
                        categories: selectedPeriodNinth,
                        accessibility: {
                            rangeDescription: `Range from  ${selectedPeriod - 10} - ${selectedPeriod}`
                        }
                    },
                    yAxis: [{
                        title: {
                            text: 'Total Cases',
                            style: {
                                color: Highcharts.getOptions().colors[0]
                            }
                        },
                        labels: {
                            style: {
                                color: Highcharts.getOptions().colors[0]
                            }
                        },
                    }],

                    plotOptions: {
                        column: {
                            stacking: 'normal',
                            dataLabels: {
                                enabled: true,
                                color: 'white'
                            }
                        },
                        line: {
                            dataLabels: {
                                enabled: true
                            },
                        }
                    },
                    series: LeprosyTotalCases

                });

                Highcharts.mapChart('highCharts_Twelfth', {
                    chart: {
                        map: 'custom/world',
                        borderWidth: 1
                    },

                    colors: ['rgba(19,64,117,0)', 'rgba(19,64,117,0.05)', 'rgba(19,64,117,0.2)', 'rgba(19,64,117,0.4)',
                        'rgba(19,64,117,0.5)', 'rgba(19,64,117,0.6)', 'rgba(19,64,117,0.8)'],

                    title: {
                        text: ""
                    },

                    mapNavigation: {
                        enabled: true
                    },

                    legend: {
                        title: {
                            text: `New leprosy cases- ${selectedPeriod}`,
                            style: {
                                color: ( // theme
                                    Highcharts.defaultOptions &&
                                    Highcharts.defaultOptions.legend &&
                                    Highcharts.defaultOptions.legend.title &&
                                    Highcharts.defaultOptions.legend.title.style &&
                                    Highcharts.defaultOptions.legend.title.style.color
                                ) || 'black'
                            }
                        },
                        align: 'left',
                        verticalAlign: 'bottom',
                        floating: true,
                        layout: 'vertical',
                        valueDecimals: 0,
                        backgroundColor: ( // theme
                            Highcharts.defaultOptions &&
                            Highcharts.defaultOptions.legend &&
                            Highcharts.defaultOptions.legend.backgroundColor
                        ) || 'rgba(255, 255, 255, 0.85)',
                        symbolRadius: 0,
                        symbolHeight: 14
                    },

                    colorAxis: {
                        dataClasses: [{
                            to: 0,
                            name: "No data"
                        }, {
                            from: 0,
                            to: 0,
                            name: '0'
                        }, {
                            from: 1,
                            to: 10
                        }, {
                            from: 11,
                            to: 100
                        }, {
                            from: 101,
                            to: 1000
                        }, {
                            from: 1001,
                            to: 10000
                        }, {
                            from: 10000,
                            name: "more than 10 000"
                        }]
                    },

                    series: [{
                        data: dataTwelfth,
                        joinBy: ['iso-a3', 'code'],
                        animation: true,
                        name: `New leprosy cases- ${selectedPeriod}`,
                        states: {
                            hover: {
                                color: '#a4edba'
                            }
                        },
                        shadow: false
                    }]
                });
            })
        }




        var tableToExcel = (function () {
            var uri = 'data:application/vnd.ms-excel;base64,'
                , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
                , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
                , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
            return function (table, name, filename) {
                if (!table.nodeType) table = document.getElementById(table)
                var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }
                document.getElementById("dlink").href = uri + base64(format(template, ctx));
                document.getElementById("dlink").download = filename;
                document.getElementById("dlink").click();
            }
        })()

        function printContent(el) {
            var restorepage = document.body.innerHTML;
            var printcontent = document.getElementById(el).innerHTML;
            document.body.innerHTML = printcontent;
            var chart = $('#highCharts_first').highcharts();
            chart.setSize(300, 500, false);
            window.print();
            document.body.innerHTML = restorepage;
        }

    </script>
</body>

</html>